[{"data":1,"prerenderedAt":1818},["ShallowReactive",2],{"/ru/writing":3,"articles-ru":36},{"id":4,"title":5,"body":6,"date":27,"description":15,"extension":28,"head":27,"meta":29,"navigation":30,"ogImage":27,"path":31,"robots":27,"schemaOrg":27,"seo":32,"sitemap":33,"stem":34,"__hash__":35},"content_ru/ru/3.writing.md","Статьи",{"type":7,"value":8,"toc":24},"minimark",[9],[10,11,12,19],"writing",{},[13,14,16],"template",{"v-slot:title":15},"",[17,18,5],"p",{},[13,20,21],{"v-slot:subtitle":15},[17,22,23],{},"Некоторые статьи на темы, близкие моему сердцу",{"title":15,"searchDepth":25,"depth":25,"links":26},2,[],null,"md",{},true,"/ru/writing",{"title":5,"description":15},{"loc":31},"ru/3.writing","mAqJY0Si63yofomegV-kZ6s05URk8OvppfjwAZPi4R4",[37],{"id":38,"title":39,"body":40,"date":1787,"description":1788,"extension":28,"head":1789,"image":1797,"meta":1798,"navigation":1799,"ogImage":1801,"path":1803,"readingTime":1804,"robots":27,"schemaOrg":1805,"seo":1806,"sitemap":1807,"stem":1810,"tags":1811,"__hash__":1817},"articles_ru/ru/articles/Web Workers в Vue.md","Web Workers в Vue: Создание, Типизация и Использование ",{"type":7,"value":41,"toc":1775},[42,47,50,53,82,87,90,262,266,293,296,395,399,402,405,428,431,438,608,611,615,618,621,624,732,735,739,742,745,748,833,836,840,843,873,876,1346,1350,1353,1356,1359,1749,1756,1760,1763,1771],[43,44,46],"h2",{"id":45},"введение-в-web-workers","Введение в Web workers",[17,48,49],{},"Web Workers — это мощный инструмент JavaScript, позволяющий выполнять скрипты в фоновом потоке, отдельно от основного потока браузера. Это означает, что тяжёлые вычисления, такие как обработка больших массивов данных, парсинг JSON или сложные математические операции, не будут блокировать пользовательский интерфейс (UI). В результате приложение остаётся отзывчивым, а пользователь не замечает \"зависаний\".",[17,51,52],{},"Почему Web Workers полезны для проектов?",[54,55,56,64,70,76],"ul",{},[57,58,59,63],"li",{},[60,61,62],"strong",{},"Улучшение производительности:"," Они позволяют распараллеливать задачи, что критично для приложений с интенсивными вычислениями (например, игры, анализ данных или реал-тайм обработка).",[57,65,66,69],{},[60,67,68],{},"Отзывчивость UI:"," Основной поток остаётся свободным для обработки событий, анимаций и рендеринга.",[57,71,72,75],{},[60,73,74],{},"Безопасность:"," Workers не имеют доступа к DOM, что предотвращает случайные мутации UI и делает код более предсказуемым.",[57,77,78,81],{},[60,79,80],{},"Масштабируемость:"," В больших проектах, таких как SPA на Vue, Workers помогают избежать bottleneck'ов в производительности.",[83,84,86],"h3",{"id":85},"проверка-поддержки-web-workers","Проверка поддержки Web Workers",[17,88,89],{},"Хоть и Webworker имеет большую поддержку браузерами документация MDN рекомендует перед использованием вебворкера проверять к нему доступ, и использовать fallback подсчета в основном потоке",[91,92,96],"pre",{"className":93,"code":94,"language":95,"meta":15,"style":15},"language-js shiki shiki-themes github-light github-dark github-dark","if(window.Worker){\n// Инициация воркера\n}\nelse{\n// fallback\n}\n// Или другой варинат взято с https://github.com/morethanwords/tweb/blob/be9ceb7354565ec5b605f89be81b4ef3e2302211/src/helpers/context.ts#L9\nexport const IS_SERVICE_WORKER = typeof ServiceWorkerGlobalScope !== 'undefined' && self instanceof ServiceWorkerGlobalScope;\nexport const IS_WEB_WORKER = typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope && !IS_SERVICE_WORKER;\nexport const IS_WORKER = IS_WEB_WORKER || IS_SERVICE_WORKER;\n//Позволяет сразу проверить какие воркеры поддерживаются в браузере  \n","js",[97,98,99,112,118,124,133,139,144,150,195,235,256],"code",{"__ignoreMap":15},[100,101,104,108],"span",{"class":102,"line":103},"line",1,[100,105,107],{"class":106},"so5gQ","if",[100,109,111],{"class":110},"slsVL","(window.Worker){\n",[100,113,114],{"class":102,"line":25},[100,115,117],{"class":116},"sCsY4","// Инициация воркера\n",[100,119,121],{"class":102,"line":120},3,[100,122,123],{"class":110},"}\n",[100,125,127,130],{"class":102,"line":126},4,[100,128,129],{"class":106},"else",[100,131,132],{"class":110},"{\n",[100,134,136],{"class":102,"line":135},5,[100,137,138],{"class":116},"// fallback\n",[100,140,142],{"class":102,"line":141},6,[100,143,123],{"class":110},[100,145,147],{"class":102,"line":146},7,[100,148,149],{"class":116},"// Или другой варинат взято с https://github.com/morethanwords/tweb/blob/be9ceb7354565ec5b605f89be81b4ef3e2302211/src/helpers/context.ts#L9\n",[100,151,153,156,159,163,166,169,172,175,179,182,185,188,192],{"class":102,"line":152},8,[100,154,155],{"class":106},"export",[100,157,158],{"class":106}," const",[100,160,162],{"class":161},"suiK_"," IS_SERVICE_WORKER",[100,164,165],{"class":106}," =",[100,167,168],{"class":106}," typeof",[100,170,171],{"class":110}," ServiceWorkerGlobalScope ",[100,173,174],{"class":106},"!==",[100,176,178],{"class":177},"sfrk1"," 'undefined'",[100,180,181],{"class":106}," &&",[100,183,184],{"class":110}," self ",[100,186,187],{"class":106},"instanceof",[100,189,191],{"class":190},"shcOC"," ServiceWorkerGlobalScope",[100,193,194],{"class":110},";\n",[100,196,198,200,202,205,207,209,212,214,216,218,220,222,225,227,230,233],{"class":102,"line":197},9,[100,199,155],{"class":106},[100,201,158],{"class":106},[100,203,204],{"class":161}," IS_WEB_WORKER",[100,206,165],{"class":106},[100,208,168],{"class":106},[100,210,211],{"class":110}," WorkerGlobalScope ",[100,213,174],{"class":106},[100,215,178],{"class":177},[100,217,181],{"class":106},[100,219,184],{"class":110},[100,221,187],{"class":106},[100,223,224],{"class":190}," WorkerGlobalScope",[100,226,181],{"class":106},[100,228,229],{"class":106}," !",[100,231,232],{"class":161},"IS_SERVICE_WORKER",[100,234,194],{"class":110},[100,236,238,240,242,245,247,249,252,254],{"class":102,"line":237},10,[100,239,155],{"class":106},[100,241,158],{"class":106},[100,243,244],{"class":161}," IS_WORKER",[100,246,165],{"class":106},[100,248,204],{"class":161},[100,250,251],{"class":106}," ||",[100,253,162],{"class":161},[100,255,194],{"class":110},[100,257,259],{"class":102,"line":258},11,[100,260,261],{"class":116},"//Позволяет сразу проверить какие воркеры поддерживаются в браузере\n",[43,263,265],{"id":264},"типизация-web-workers-с-typescript","Типизация Web Workers с TypeScript",[267,268,269,280,287],"ol",{},[57,270,271,272,275,276,279],{},"Определите интерфейсы для сообщений (например, ",[97,273,274],{},"WorkerMessage"," для входящих и ",[97,277,278],{},"WorkerResponse"," для исходящих).",[57,281,282,283,286],{},"Используйте ",[97,284,285],{},"Worker"," как тип для экземпляра worker'а.",[57,288,289,290],{},"Типизируйте обработчики событий с ",[97,291,292],{},"MessageEvent",[17,294,295],{},"Основные шаги:",[91,297,300],{"className":93,"code":298,"filename":299,"language":95,"meta":15,"style":15},"export interface WorkerMessage {\n  type: 'compute';\n  data: number[]; // Массив чисел для обработки\n}\n\nexport interface WorkerResponse {\n  type: 'result';\n  result: number; // Результат вычислений\n}\n","worker-types.ts",[97,301,302,315,329,345,349,354,365,376,391],{"__ignoreMap":15},[100,303,304,306,309,312],{"class":102,"line":103},[100,305,155],{"class":106},[100,307,308],{"class":106}," interface",[100,310,311],{"class":190}," WorkerMessage",[100,313,314],{"class":110}," {\n",[100,316,317,321,324,327],{"class":102,"line":25},[100,318,320],{"class":319},"sQHwn","  type",[100,322,323],{"class":106},":",[100,325,326],{"class":177}," 'compute'",[100,328,194],{"class":110},[100,330,331,334,336,339,342],{"class":102,"line":120},[100,332,333],{"class":319},"  data",[100,335,323],{"class":106},[100,337,338],{"class":161}," number",[100,340,341],{"class":110},"[]; ",[100,343,344],{"class":116},"// Массив чисел для обработки\n",[100,346,347],{"class":102,"line":126},[100,348,123],{"class":110},[100,350,351],{"class":102,"line":135},[100,352,353],{"emptyLinePlaceholder":30},"\n",[100,355,356,358,360,363],{"class":102,"line":141},[100,357,155],{"class":106},[100,359,308],{"class":106},[100,361,362],{"class":190}," WorkerResponse",[100,364,314],{"class":110},[100,366,367,369,371,374],{"class":102,"line":146},[100,368,320],{"class":319},[100,370,323],{"class":106},[100,372,373],{"class":177}," 'result'",[100,375,194],{"class":110},[100,377,378,381,383,385,388],{"class":102,"line":152},[100,379,380],{"class":319},"  result",[100,382,323],{"class":106},[100,384,338],{"class":161},[100,386,387],{"class":110},"; ",[100,389,390],{"class":116},"// Результат вычислений\n",[100,392,393],{"class":102,"line":197},[100,394,123],{"class":110},[43,396,398],{"id":397},"создание-web-worker-в-vue","Создание Web Worker в Vue",[17,400,401],{},"В Vue.js Web Workers создаются как отдельные файлы (например, my-worker.ts), которые импортируются в компоненты. Vue не имеет встроенной поддержки Workers, но их легко интегрировать.",[17,403,404],{},"Шаги по созданию:",[267,406,407,414,421],{},[57,408,409,410,413],{},"Создайте файл worker'а в директории ",[97,411,412],{},"src/workers/"," (или любой другой).",[57,415,416,417,420],{},"В файле worker'а обработайте сообщения с помощью ",[97,418,419],{},"self.onmessage",".",[57,422,423,424,427],{},"В Vue-компоненте создайте экземпляр new ",[97,425,426],{},"Worker()"," с путём к файлу.",[17,429,430],{},"Важно: Если вы используете Vite (стандартный бандлер для Vue 3), добавьте ?worker в импорт, чтобы Vite правильно обработал worker как отдельный чанк.",[17,432,433,434,437],{},"Пример файла worker'а ",[97,435,436],{},"src/workers/sum-worker.ts","):",[91,439,442],{"className":93,"code":440,"filename":441,"language":95,"meta":15,"style":15},"import type { WorkerMessage, WorkerResponse } from '../types/worker-types';\n\nself.onmessage = (event: MessageEvent\u003CWorkerMessage>) => {\n  if (event.data.type === 'compute') {\n    const sum = event.data.data.reduce((acc, val) => acc + val, 0);\n    const response: WorkerResponse = { type: 'result', result: sum };\n    self.postMessage(response);\n  }\n};\n","sum-worker.ts",[97,443,444,463,467,501,517,565,587,598,603],{"__ignoreMap":15},[100,445,446,449,452,455,458,461],{"class":102,"line":103},[100,447,448],{"class":106},"import",[100,450,451],{"class":106}," type",[100,453,454],{"class":110}," { WorkerMessage, WorkerResponse } ",[100,456,457],{"class":106},"from",[100,459,460],{"class":177}," '../types/worker-types'",[100,462,194],{"class":110},[100,464,465],{"class":102,"line":25},[100,466,353],{"emptyLinePlaceholder":30},[100,468,469,472,475,477,480,483,485,488,491,493,496,499],{"class":102,"line":120},[100,470,471],{"class":110},"self.",[100,473,474],{"class":190},"onmessage",[100,476,165],{"class":106},[100,478,479],{"class":110}," (",[100,481,482],{"class":319},"event",[100,484,323],{"class":106},[100,486,487],{"class":190}," MessageEvent",[100,489,490],{"class":110},"\u003C",[100,492,274],{"class":190},[100,494,495],{"class":110},">) ",[100,497,498],{"class":106},"=>",[100,500,314],{"class":110},[100,502,503,506,509,512,514],{"class":102,"line":126},[100,504,505],{"class":106},"  if",[100,507,508],{"class":110}," (event.data.type ",[100,510,511],{"class":106},"===",[100,513,326],{"class":177},[100,515,516],{"class":110},") {\n",[100,518,519,522,525,527,530,533,536,539,542,545,548,550,553,556,559,562],{"class":102,"line":135},[100,520,521],{"class":106},"    const",[100,523,524],{"class":161}," sum",[100,526,165],{"class":106},[100,528,529],{"class":110}," event.data.data.",[100,531,532],{"class":190},"reduce",[100,534,535],{"class":110},"((",[100,537,538],{"class":319},"acc",[100,540,541],{"class":110},", ",[100,543,544],{"class":319},"val",[100,546,547],{"class":110},") ",[100,549,498],{"class":106},[100,551,552],{"class":110}," acc ",[100,554,555],{"class":106},"+",[100,557,558],{"class":110}," val, ",[100,560,561],{"class":161},"0",[100,563,564],{"class":110},");\n",[100,566,567,569,572,574,576,578,581,584],{"class":102,"line":141},[100,568,521],{"class":106},[100,570,571],{"class":161}," response",[100,573,323],{"class":106},[100,575,362],{"class":190},[100,577,165],{"class":106},[100,579,580],{"class":110}," { type: ",[100,582,583],{"class":177},"'result'",[100,585,586],{"class":110},", result: sum };\n",[100,588,589,592,595],{"class":102,"line":146},[100,590,591],{"class":110},"    self.",[100,593,594],{"class":190},"postMessage",[100,596,597],{"class":110},"(response);\n",[100,599,600],{"class":102,"line":152},[100,601,602],{"class":110},"  }\n",[100,604,605],{"class":102,"line":197},[100,606,607],{"class":110},"};\n",[17,609,610],{},"Этот worker будет суммирует массив чисел в фоне.",[43,612,614],{"id":613},"передача-данных-в-web-workers-копирование-vs-transfer","Передача данных в Web Workers: Копирование vs. Transfer",[17,616,617],{},"При передаче данных в Web Worker через postMessage обычные данные (например, объекты, массивы, строки) копируются с помощью алгоритма structured clone. Это означает, что создаётся глубокая копия данных, что может быть ресурсоёмким для больших объёмов информации, но позволяет обоим потокам работать с данными независимо.",[17,619,620],{},"Однако для \"битовых\" данных, таких как ArrayBuffer, TypedArray (например, Float32Array) или другие transferable объекты (MessagePort, ImageBitmap и т.д.), можно использовать опцию transfer. В этом случае данные не копируются, а передаются: владение объектом переходит к worker'у, и он становится недоступным в основном потоке. Это экономит память и время, особенно для больших буферов данных (например, аудио или видео).",[17,622,623],{},"Пример передачи с transfer:",[91,625,627],{"className":93,"code":626,"language":95,"meta":15,"style":15},"// В основном потоке\nconst buffer = new Float32Array(1000000); // Большой буфер\nworker.postMessage({ type: 'process', buffer }, [buffer]); // Передаём buffer без копирования\n\n// В worker'е\nself.onmessage = (event) => {\n  const buffer = event.data.buffer; // Теперь buffer доступен только здесь\n  // Обработка...\n};\n",[97,628,629,634,662,681,685,690,708,723,728],{"__ignoreMap":15},[100,630,631],{"class":102,"line":103},[100,632,633],{"class":116},"// В основном потоке\n",[100,635,636,639,642,644,647,650,653,656,659],{"class":102,"line":25},[100,637,638],{"class":106},"const",[100,640,641],{"class":161}," buffer",[100,643,165],{"class":106},[100,645,646],{"class":106}," new",[100,648,649],{"class":190}," Float32Array",[100,651,652],{"class":110},"(",[100,654,655],{"class":161},"1000000",[100,657,658],{"class":110},"); ",[100,660,661],{"class":116},"// Большой буфер\n",[100,663,664,667,669,672,675,678],{"class":102,"line":120},[100,665,666],{"class":110},"worker.",[100,668,594],{"class":190},[100,670,671],{"class":110},"({ type: ",[100,673,674],{"class":177},"'process'",[100,676,677],{"class":110},", buffer }, [buffer]); ",[100,679,680],{"class":116},"// Передаём buffer без копирования\n",[100,682,683],{"class":102,"line":126},[100,684,353],{"emptyLinePlaceholder":30},[100,686,687],{"class":102,"line":135},[100,688,689],{"class":116},"// В worker'е\n",[100,691,692,694,696,698,700,702,704,706],{"class":102,"line":141},[100,693,471],{"class":110},[100,695,474],{"class":190},[100,697,165],{"class":106},[100,699,479],{"class":110},[100,701,482],{"class":319},[100,703,547],{"class":110},[100,705,498],{"class":106},[100,707,314],{"class":110},[100,709,710,713,715,717,720],{"class":102,"line":146},[100,711,712],{"class":106},"  const",[100,714,641],{"class":161},[100,716,165],{"class":106},[100,718,719],{"class":110}," event.data.buffer; ",[100,721,722],{"class":116},"// Теперь buffer доступен только здесь\n",[100,724,725],{"class":102,"line":152},[100,726,727],{"class":116},"  // Обработка...\n",[100,729,730],{"class":102,"line":197},[100,731,607],{"class":110},[17,733,734],{},"Если не использовать transfer для transferable объектов, они всё равно скопируются, но transfer оптимизирует процесс. Это особенно полезно в сценариях с реал-тайм обработкой данных, как в проекте TunA с аудио-буферами. Данный способ используется в веб версии телеграмма для обработки WAV форматов и видео форматов.",[43,736,738],{"id":737},"обход-троттлинга-таймеров-с-помощью-web-workers","Обход троттлинга таймеров с помощью Web Workers",[17,740,741],{},"В браузерах функции setTimeout и setInterval в основном потоке подвержены троттлингу (throttling) в неактивных вкладках (background tabs). Это сделано для экономии ресурсов CPU и батареи: если вкладка не видима, браузер может увеличивать минимальный интервал таймера до 1 секунды или больше. Со временем троттлинг усиливается — интервал может расти до 2 секунд, 3 секунд и т.д., что приводит к неточным срабатываниям. Это проблема для приложений, требующих точного тайминга, таких как реал-тайм обновления, анимации или мониторинг.",[17,743,744],{},"Однако, если вынести таймеры в Web Worker, они продолжают работать с высокой точностью, независимо от активности вкладки. Workers не зависят от видимости страницы и не подвержены такому троттлингу, обеспечивая постоянные и точные интервалы. Это делает их идеальными для фоновых задач, требующих стабильного расписания.",[17,746,747],{},"Пример в worker'е для точного таймера:",[91,749,752],{"className":93,"code":750,"filename":751,"language":95,"meta":15,"style":15},"self.onmessage = (event) => {\n  if (event.data === 'start') {\n    setInterval(() => {\n      self.postMessage('tick'); // Отправляем сигнал каждую секунду точно\n    }, 1000);\n  }\n};\n","timer-worker.ts",[97,753,754,772,786,798,815,825,829],{"__ignoreMap":15},[100,755,756,758,760,762,764,766,768,770],{"class":102,"line":103},[100,757,471],{"class":110},[100,759,474],{"class":190},[100,761,165],{"class":106},[100,763,479],{"class":110},[100,765,482],{"class":319},[100,767,547],{"class":110},[100,769,498],{"class":106},[100,771,314],{"class":110},[100,773,774,776,779,781,784],{"class":102,"line":25},[100,775,505],{"class":106},[100,777,778],{"class":110}," (event.data ",[100,780,511],{"class":106},[100,782,783],{"class":177}," 'start'",[100,785,516],{"class":110},[100,787,788,791,794,796],{"class":102,"line":120},[100,789,790],{"class":190},"    setInterval",[100,792,793],{"class":110},"(() ",[100,795,498],{"class":106},[100,797,314],{"class":110},[100,799,800,803,805,807,810,812],{"class":102,"line":126},[100,801,802],{"class":110},"      self.",[100,804,594],{"class":190},[100,806,652],{"class":110},[100,808,809],{"class":177},"'tick'",[100,811,658],{"class":110},[100,813,814],{"class":116},"// Отправляем сигнал каждую секунду точно\n",[100,816,817,820,823],{"class":102,"line":135},[100,818,819],{"class":110},"    }, ",[100,821,822],{"class":161},"1000",[100,824,564],{"class":110},[100,826,827],{"class":102,"line":141},[100,828,602],{"class":110},[100,830,831],{"class":102,"line":146},[100,832,607],{"class":110},[17,834,835],{},"В основном потоке слушайте сообщения от worker'а для обработки \"тиков\". Это решает проблему в сценариях, где точность критична, например, в часах, уведомлениях или реал-тайм данных.",[43,837,839],{"id":838},"использование-web-worker-в-vue-компоненте","Использование Web Worker в Vue-компоненте",[17,841,842],{},"Механизм работы достаточно схож с WebSocket.",[267,844,845,848,851,856,862],{},[57,846,847],{},"Импортируйте worker.",[57,849,850],{},"Создайте экземпляр.",[57,852,853,854,420],{},"Отправляйте сообщения с ",[97,855,594],{},[57,857,858,859,861],{},"Обработайте ответы с ",[97,860,474],{}," .",[57,863,864,865,868,869,872],{},"Не забудьте завершить worker с ",[97,866,867],{},"terminate()",", когда он не нужен (например, в ",[97,870,871],{},"onUnmounted",") чтобы избежать memory leaks.",[17,874,875],{},"Тут представлен механиз работы, не самый чистый но достаточно понятный.",[91,877,881],{"className":878,"code":879,"language":880,"meta":15,"style":15},"language-vue shiki shiki-themes github-light github-dark github-dark","\u003Ctemplate>\n  \u003Cdiv>\n    \u003Cbutton @click=\"computeSum\">Вычислить сумму\u003C/button>\n    \u003Cp>Результат: {{ result }}\u003C/p>\n  \u003C/div>\n\u003C/template>\n\u003Cscript setup lang=\"ts\">\nimport { ref, onUnmounted } from 'vue';\nimport type { WorkerMessage, WorkerResponse } from './types/worker-types';\n// В воркер передаем ссылку того где он находится (конкретно этот пример с Vite)\nconst WorkerConstructor = () => new Worker(new URL('./workers/sum-worker.ts', import.meta.url), { type: 'module' });\n// Если требуется реактивность класса Worker его можно обернуть в shadllowRef чтобы не делать всю структуру реактивной\nconst worker = WorkerConstructor();\nconst result = ref\u003Cnumber | null>(null);\n\n// ждем ответа от воркера\nworker.onmessage = (event: MessageEvent\u003CWorkerResponse>) => {\n  if (event.data.type === 'result') {\n    result.value = event.data.result;\n  }\n};\n// отправляем данные для подсчета\nconst computeSum = () => {\n  const data: number[] = Array.from({ length: 1000000 }, () => Math.random() * 100);\n  const message: WorkerMessage = { type: 'compute', data };\n  worker.postMessage(message);\n};\n// отчищаем память\nonUnmounted(() => {\n  worker.terminate();\n});\n\u003C/script>\n","vue",[97,882,883,893,903,935,948,957,966,986,1000,1015,1020,1070,1076,1091,1123,1128,1134,1161,1174,1185,1190,1195,1201,1217,1266,1288,1299,1304,1310,1321,1331,1337],{"__ignoreMap":15},[100,884,885,887,890],{"class":102,"line":103},[100,886,490],{"class":110},[100,888,13],{"class":889},"sByVh",[100,891,892],{"class":110},">\n",[100,894,895,898,901],{"class":102,"line":25},[100,896,897],{"class":110},"  \u003C",[100,899,900],{"class":889},"div",[100,902,892],{"class":110},[100,904,905,908,911,914,917,920,923,926,928,931,933],{"class":102,"line":120},[100,906,907],{"class":110},"    \u003C",[100,909,910],{"class":889},"button",[100,912,913],{"class":110}," @",[100,915,916],{"class":190},"click",[100,918,919],{"class":110},"=",[100,921,922],{"class":177},"\"",[100,924,925],{"class":110},"computeSum",[100,927,922],{"class":177},[100,929,930],{"class":110},">Вычислить сумму\u003C/",[100,932,910],{"class":889},[100,934,892],{"class":110},[100,936,937,939,941,944,946],{"class":102,"line":126},[100,938,907],{"class":110},[100,940,17],{"class":889},[100,942,943],{"class":110},">Результат: {{ result }}\u003C/",[100,945,17],{"class":889},[100,947,892],{"class":110},[100,949,950,953,955],{"class":102,"line":135},[100,951,952],{"class":110},"  \u003C/",[100,954,900],{"class":889},[100,956,892],{"class":110},[100,958,959,962,964],{"class":102,"line":141},[100,960,961],{"class":110},"\u003C/",[100,963,13],{"class":889},[100,965,892],{"class":110},[100,967,968,970,973,976,979,981,984],{"class":102,"line":146},[100,969,490],{"class":110},[100,971,972],{"class":889},"script",[100,974,975],{"class":190}," setup",[100,977,978],{"class":190}," lang",[100,980,919],{"class":110},[100,982,983],{"class":177},"\"ts\"",[100,985,892],{"class":110},[100,987,988,990,993,995,998],{"class":102,"line":152},[100,989,448],{"class":106},[100,991,992],{"class":110}," { ref, onUnmounted } ",[100,994,457],{"class":106},[100,996,997],{"class":177}," 'vue'",[100,999,194],{"class":110},[100,1001,1002,1004,1006,1008,1010,1013],{"class":102,"line":197},[100,1003,448],{"class":106},[100,1005,451],{"class":106},[100,1007,454],{"class":110},[100,1009,457],{"class":106},[100,1011,1012],{"class":177}," './types/worker-types'",[100,1014,194],{"class":110},[100,1016,1017],{"class":102,"line":237},[100,1018,1019],{"class":116},"// В воркер передаем ссылку того где он находится (конкретно этот пример с Vite)\n",[100,1021,1022,1024,1027,1029,1032,1034,1036,1039,1041,1044,1047,1049,1052,1054,1056,1058,1061,1064,1067],{"class":102,"line":258},[100,1023,638],{"class":106},[100,1025,1026],{"class":190}," WorkerConstructor",[100,1028,165],{"class":106},[100,1030,1031],{"class":110}," () ",[100,1033,498],{"class":106},[100,1035,646],{"class":106},[100,1037,1038],{"class":190}," Worker",[100,1040,652],{"class":110},[100,1042,1043],{"class":106},"new",[100,1045,1046],{"class":190}," URL",[100,1048,652],{"class":110},[100,1050,1051],{"class":177},"'./workers/sum-worker.ts'",[100,1053,541],{"class":110},[100,1055,448],{"class":106},[100,1057,420],{"class":110},[100,1059,1060],{"class":161},"meta",[100,1062,1063],{"class":110},".url), { type: ",[100,1065,1066],{"class":177},"'module'",[100,1068,1069],{"class":110}," });\n",[100,1071,1073],{"class":102,"line":1072},12,[100,1074,1075],{"class":116},"// Если требуется реактивность класса Worker его можно обернуть в shadllowRef чтобы не делать всю структуру реактивной\n",[100,1077,1079,1081,1084,1086,1088],{"class":102,"line":1078},13,[100,1080,638],{"class":106},[100,1082,1083],{"class":161}," worker",[100,1085,165],{"class":106},[100,1087,1026],{"class":190},[100,1089,1090],{"class":110},"();\n",[100,1092,1094,1096,1099,1101,1104,1106,1109,1112,1115,1118,1121],{"class":102,"line":1093},14,[100,1095,638],{"class":106},[100,1097,1098],{"class":161}," result",[100,1100,165],{"class":106},[100,1102,1103],{"class":190}," ref",[100,1105,490],{"class":110},[100,1107,1108],{"class":161},"number",[100,1110,1111],{"class":106}," |",[100,1113,1114],{"class":161}," null",[100,1116,1117],{"class":110},">(",[100,1119,1120],{"class":161},"null",[100,1122,564],{"class":110},[100,1124,1126],{"class":102,"line":1125},15,[100,1127,353],{"emptyLinePlaceholder":30},[100,1129,1131],{"class":102,"line":1130},16,[100,1132,1133],{"class":116},"// ждем ответа от воркера\n",[100,1135,1137,1139,1141,1143,1145,1147,1149,1151,1153,1155,1157,1159],{"class":102,"line":1136},17,[100,1138,666],{"class":110},[100,1140,474],{"class":190},[100,1142,165],{"class":106},[100,1144,479],{"class":110},[100,1146,482],{"class":319},[100,1148,323],{"class":106},[100,1150,487],{"class":190},[100,1152,490],{"class":110},[100,1154,278],{"class":190},[100,1156,495],{"class":110},[100,1158,498],{"class":106},[100,1160,314],{"class":110},[100,1162,1164,1166,1168,1170,1172],{"class":102,"line":1163},18,[100,1165,505],{"class":106},[100,1167,508],{"class":110},[100,1169,511],{"class":106},[100,1171,373],{"class":177},[100,1173,516],{"class":110},[100,1175,1177,1180,1182],{"class":102,"line":1176},19,[100,1178,1179],{"class":110},"    result.value ",[100,1181,919],{"class":106},[100,1183,1184],{"class":110}," event.data.result;\n",[100,1186,1188],{"class":102,"line":1187},20,[100,1189,602],{"class":110},[100,1191,1193],{"class":102,"line":1192},21,[100,1194,607],{"class":110},[100,1196,1198],{"class":102,"line":1197},22,[100,1199,1200],{"class":116},"// отправляем данные для подсчета\n",[100,1202,1204,1206,1209,1211,1213,1215],{"class":102,"line":1203},23,[100,1205,638],{"class":106},[100,1207,1208],{"class":190}," computeSum",[100,1210,165],{"class":106},[100,1212,1031],{"class":110},[100,1214,498],{"class":106},[100,1216,314],{"class":110},[100,1218,1220,1222,1225,1227,1229,1232,1234,1237,1239,1242,1244,1247,1249,1252,1255,1258,1261,1264],{"class":102,"line":1219},24,[100,1221,712],{"class":106},[100,1223,1224],{"class":161}," data",[100,1226,323],{"class":106},[100,1228,338],{"class":161},[100,1230,1231],{"class":110},"[] ",[100,1233,919],{"class":106},[100,1235,1236],{"class":110}," Array.",[100,1238,457],{"class":190},[100,1240,1241],{"class":110},"({ length: ",[100,1243,655],{"class":161},[100,1245,1246],{"class":110}," }, () ",[100,1248,498],{"class":106},[100,1250,1251],{"class":110}," Math.",[100,1253,1254],{"class":190},"random",[100,1256,1257],{"class":110},"() ",[100,1259,1260],{"class":106},"*",[100,1262,1263],{"class":161}," 100",[100,1265,564],{"class":110},[100,1267,1269,1271,1274,1276,1278,1280,1282,1285],{"class":102,"line":1268},25,[100,1270,712],{"class":106},[100,1272,1273],{"class":161}," message",[100,1275,323],{"class":106},[100,1277,311],{"class":190},[100,1279,165],{"class":106},[100,1281,580],{"class":110},[100,1283,1284],{"class":177},"'compute'",[100,1286,1287],{"class":110},", data };\n",[100,1289,1291,1294,1296],{"class":102,"line":1290},26,[100,1292,1293],{"class":110},"  worker.",[100,1295,594],{"class":190},[100,1297,1298],{"class":110},"(message);\n",[100,1300,1302],{"class":102,"line":1301},27,[100,1303,607],{"class":110},[100,1305,1307],{"class":102,"line":1306},28,[100,1308,1309],{"class":116},"// отчищаем память\n",[100,1311,1313,1315,1317,1319],{"class":102,"line":1312},29,[100,1314,871],{"class":190},[100,1316,793],{"class":110},[100,1318,498],{"class":106},[100,1320,314],{"class":110},[100,1322,1324,1326,1329],{"class":102,"line":1323},30,[100,1325,1293],{"class":110},[100,1327,1328],{"class":190},"terminate",[100,1330,1090],{"class":110},[100,1332,1334],{"class":102,"line":1333},31,[100,1335,1336],{"class":110},"});\n",[100,1338,1340,1342,1344],{"class":102,"line":1339},32,[100,1341,961],{"class":110},[100,1343,972],{"class":889},[100,1345,892],{"class":110},[43,1347,1349],{"id":1348},"реальный-кейс-проект-tuna","Реальный кейс: Проект TunA",[17,1351,1352],{},"В проекте TunA возникла проблема с производительностью и блокировкой UI из-за частых расчётов частоты (frequency calculations), даже при использовании debounce. Эти расчёты выполнялись в основном потоке, что приводило к \"зависаниям\" интерфейса, особенно при обработке реал-тайм данных или больших объёмов информации.",[17,1354,1355],{},"Чтобы решить эту проблему, было принято решение добавить Web Worker. Расчёты частоты были вынесены в отдельный поток, что позволило основному потоку оставаться свободным для рендеринга и обработки пользовательских взаимодействий. В результате UI стал более отзывчивым, а производительность значительно улучшилась. Это отличный пример, как Web Workers могут спасти проект от bottleneck'ов в реальных сценариях, связанных с интенсивными вычислениями.",[17,1357,1358],{},"Реализация вебворкера на этом проекте:",[91,1360,1363],{"className":93,"code":1361,"filename":1362,"language":95,"meta":15,"style":15},"import { PitchDetector } from \"pitchy\";\nimport { TUNER_CONFIG } from \"@/constants/tuner\";\nimport { PitchWorkerInput } from \"@/types/worker\";\n\nlet detector: PitchDetector\u003CFloat32Array> | null = null;\n\nconst isValidPitch = (pitch: number, clarity: number): boolean => {\n  return (\n    clarity > TUNER_CONFIG.MIN_CLARITY &&\n    pitch >= TUNER_CONFIG.MIN_FREQUENCY &&\n    pitch \u003C= TUNER_CONFIG.MAX_FREQUENCY\n  );\n};\n\nself.onmessage = (e: MessageEvent\u003CPitchWorkerInput>) => {\n  const { buffer, sampleRate } = e.data;\n\n  if (!detector) {\n    detector = PitchDetector.forFloat32Array(buffer.length);\n  }\n  const [pitch, clarity] = detector.findPitch(buffer, sampleRate);\n\n  if (isValidPitch(pitch, clarity)) {\n    self.postMessage({ pitch, clarity });\n  }\n};\n\n// Отчистка памяти\nself.onclose = () => {\n  detector = null;\n};\n","pitchWorker.ts",[97,1364,1365,1379,1393,1407,1411,1443,1447,1487,1495,1514,1531,1545,1550,1554,1558,1586,1609,1613,1625,1646,1650,1677,1681,1693,1702,1706,1710,1714,1719,1734,1745],{"__ignoreMap":15},[100,1366,1367,1369,1372,1374,1377],{"class":102,"line":103},[100,1368,448],{"class":106},[100,1370,1371],{"class":110}," { PitchDetector } ",[100,1373,457],{"class":106},[100,1375,1376],{"class":177}," \"pitchy\"",[100,1378,194],{"class":110},[100,1380,1381,1383,1386,1388,1391],{"class":102,"line":25},[100,1382,448],{"class":106},[100,1384,1385],{"class":110}," { TUNER_CONFIG } ",[100,1387,457],{"class":106},[100,1389,1390],{"class":177}," \"@/constants/tuner\"",[100,1392,194],{"class":110},[100,1394,1395,1397,1400,1402,1405],{"class":102,"line":120},[100,1396,448],{"class":106},[100,1398,1399],{"class":110}," { PitchWorkerInput } ",[100,1401,457],{"class":106},[100,1403,1404],{"class":177}," \"@/types/worker\"",[100,1406,194],{"class":110},[100,1408,1409],{"class":102,"line":126},[100,1410,353],{"emptyLinePlaceholder":30},[100,1412,1413,1416,1419,1421,1424,1426,1429,1432,1435,1437,1439,1441],{"class":102,"line":135},[100,1414,1415],{"class":106},"let",[100,1417,1418],{"class":110}," detector",[100,1420,323],{"class":106},[100,1422,1423],{"class":190}," PitchDetector",[100,1425,490],{"class":110},[100,1427,1428],{"class":190},"Float32Array",[100,1430,1431],{"class":110},"> ",[100,1433,1434],{"class":106},"|",[100,1436,1114],{"class":161},[100,1438,165],{"class":106},[100,1440,1114],{"class":161},[100,1442,194],{"class":110},[100,1444,1445],{"class":102,"line":141},[100,1446,353],{"emptyLinePlaceholder":30},[100,1448,1449,1451,1454,1456,1458,1461,1463,1465,1467,1470,1472,1474,1477,1479,1482,1485],{"class":102,"line":146},[100,1450,638],{"class":106},[100,1452,1453],{"class":190}," isValidPitch",[100,1455,165],{"class":106},[100,1457,479],{"class":110},[100,1459,1460],{"class":319},"pitch",[100,1462,323],{"class":106},[100,1464,338],{"class":161},[100,1466,541],{"class":110},[100,1468,1469],{"class":319},"clarity",[100,1471,323],{"class":106},[100,1473,338],{"class":161},[100,1475,1476],{"class":110},")",[100,1478,323],{"class":106},[100,1480,1481],{"class":161}," boolean",[100,1483,1484],{"class":106}," =>",[100,1486,314],{"class":110},[100,1488,1489,1492],{"class":102,"line":152},[100,1490,1491],{"class":106},"  return",[100,1493,1494],{"class":110}," (\n",[100,1496,1497,1500,1503,1506,1508,1511],{"class":102,"line":197},[100,1498,1499],{"class":110},"    clarity ",[100,1501,1502],{"class":106},">",[100,1504,1505],{"class":161}," TUNER_CONFIG",[100,1507,420],{"class":110},[100,1509,1510],{"class":161},"MIN_CLARITY",[100,1512,1513],{"class":106}," &&\n",[100,1515,1516,1519,1522,1524,1526,1529],{"class":102,"line":237},[100,1517,1518],{"class":110},"    pitch ",[100,1520,1521],{"class":106},">=",[100,1523,1505],{"class":161},[100,1525,420],{"class":110},[100,1527,1528],{"class":161},"MIN_FREQUENCY",[100,1530,1513],{"class":106},[100,1532,1533,1535,1538,1540,1542],{"class":102,"line":258},[100,1534,1518],{"class":110},[100,1536,1537],{"class":106},"\u003C=",[100,1539,1505],{"class":161},[100,1541,420],{"class":110},[100,1543,1544],{"class":161},"MAX_FREQUENCY\n",[100,1546,1547],{"class":102,"line":1072},[100,1548,1549],{"class":110},"  );\n",[100,1551,1552],{"class":102,"line":1078},[100,1553,607],{"class":110},[100,1555,1556],{"class":102,"line":1093},[100,1557,353],{"emptyLinePlaceholder":30},[100,1559,1560,1562,1564,1566,1568,1571,1573,1575,1577,1580,1582,1584],{"class":102,"line":1125},[100,1561,471],{"class":110},[100,1563,474],{"class":190},[100,1565,165],{"class":106},[100,1567,479],{"class":110},[100,1569,1570],{"class":319},"e",[100,1572,323],{"class":106},[100,1574,487],{"class":190},[100,1576,490],{"class":110},[100,1578,1579],{"class":190},"PitchWorkerInput",[100,1581,495],{"class":110},[100,1583,498],{"class":106},[100,1585,314],{"class":110},[100,1587,1588,1590,1593,1596,1598,1601,1604,1606],{"class":102,"line":1130},[100,1589,712],{"class":106},[100,1591,1592],{"class":110}," { ",[100,1594,1595],{"class":161},"buffer",[100,1597,541],{"class":110},[100,1599,1600],{"class":161},"sampleRate",[100,1602,1603],{"class":110}," } ",[100,1605,919],{"class":106},[100,1607,1608],{"class":110}," e.data;\n",[100,1610,1611],{"class":102,"line":1136},[100,1612,353],{"emptyLinePlaceholder":30},[100,1614,1615,1617,1619,1622],{"class":102,"line":1163},[100,1616,505],{"class":106},[100,1618,479],{"class":110},[100,1620,1621],{"class":106},"!",[100,1623,1624],{"class":110},"detector) {\n",[100,1626,1627,1630,1632,1635,1638,1641,1644],{"class":102,"line":1176},[100,1628,1629],{"class":110},"    detector ",[100,1631,919],{"class":106},[100,1633,1634],{"class":110}," PitchDetector.",[100,1636,1637],{"class":190},"forFloat32Array",[100,1639,1640],{"class":110},"(buffer.",[100,1642,1643],{"class":161},"length",[100,1645,564],{"class":110},[100,1647,1648],{"class":102,"line":1187},[100,1649,602],{"class":110},[100,1651,1652,1654,1657,1659,1661,1663,1666,1668,1671,1674],{"class":102,"line":1192},[100,1653,712],{"class":106},[100,1655,1656],{"class":110}," [",[100,1658,1460],{"class":161},[100,1660,541],{"class":110},[100,1662,1469],{"class":161},[100,1664,1665],{"class":110},"] ",[100,1667,919],{"class":106},[100,1669,1670],{"class":110}," detector.",[100,1672,1673],{"class":190},"findPitch",[100,1675,1676],{"class":110},"(buffer, sampleRate);\n",[100,1678,1679],{"class":102,"line":1197},[100,1680,353],{"emptyLinePlaceholder":30},[100,1682,1683,1685,1687,1690],{"class":102,"line":1203},[100,1684,505],{"class":106},[100,1686,479],{"class":110},[100,1688,1689],{"class":190},"isValidPitch",[100,1691,1692],{"class":110},"(pitch, clarity)) {\n",[100,1694,1695,1697,1699],{"class":102,"line":1219},[100,1696,591],{"class":110},[100,1698,594],{"class":190},[100,1700,1701],{"class":110},"({ pitch, clarity });\n",[100,1703,1704],{"class":102,"line":1268},[100,1705,602],{"class":110},[100,1707,1708],{"class":102,"line":1290},[100,1709,607],{"class":110},[100,1711,1712],{"class":102,"line":1301},[100,1713,353],{"emptyLinePlaceholder":30},[100,1715,1716],{"class":102,"line":1306},[100,1717,1718],{"class":116},"// Отчистка памяти\n",[100,1720,1721,1723,1726,1728,1730,1732],{"class":102,"line":1312},[100,1722,471],{"class":110},[100,1724,1725],{"class":190},"onclose",[100,1727,165],{"class":106},[100,1729,1031],{"class":110},[100,1731,498],{"class":106},[100,1733,314],{"class":110},[100,1735,1736,1739,1741,1743],{"class":102,"line":1323},[100,1737,1738],{"class":110},"  detector ",[100,1740,919],{"class":106},[100,1742,1114],{"class":161},[100,1744,194],{"class":110},[100,1746,1747],{"class":102,"line":1333},[100,1748,607],{"class":110},[17,1750,1751,1752,1755],{},"В этом примере worker обрабатывает аудио-буфер для определения pitch (частоты тона) с помощью библиотеки ",[97,1753,1754],{},"pitchy",", фильтруя результаты по валидности и отправляя только релевантные данные обратно в основной поток.",[43,1757,1759],{"id":1758},"преимущества-в-реальных-проектах","Преимущества в реальных проектах",[17,1761,1762],{},"В проектах Web Workers особенно полезны для:",[54,1764,1765,1768],{},[57,1766,1767],{},"Обработки больших данных (например, в дашбордах с графиками).",[57,1769,1770],{},"Реал-тайм приложений (чаты, игры), где нужно обрабатывать события без задержек.",[1772,1773,1774],"style",{},"html pre.shiki code .so5gQ, html code.shiki .so5gQ{--shiki-light:#D73A49;--shiki-default:#F97583;--shiki-dark:#F97583}html pre.shiki code .slsVL, html code.shiki .slsVL{--shiki-light:#24292E;--shiki-default:#E1E4E8;--shiki-dark:#E1E4E8}html pre.shiki code .sCsY4, html code.shiki .sCsY4{--shiki-light:#6A737D;--shiki-default:#6A737D;--shiki-dark:#6A737D}html pre.shiki code .suiK_, html code.shiki .suiK_{--shiki-light:#005CC5;--shiki-default:#79B8FF;--shiki-dark:#79B8FF}html pre.shiki code .sfrk1, html code.shiki .sfrk1{--shiki-light:#032F62;--shiki-default:#9ECBFF;--shiki-dark:#9ECBFF}html pre.shiki code .shcOC, html code.shiki .shcOC{--shiki-light:#6F42C1;--shiki-default:#B392F0;--shiki-dark:#B392F0}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sQHwn, html code.shiki .sQHwn{--shiki-light:#E36209;--shiki-default:#FFAB70;--shiki-dark:#FFAB70}html pre.shiki code .sByVh, html code.shiki .sByVh{--shiki-light:#22863A;--shiki-default:#85E89D;--shiki-dark:#85E89D}",{"title":15,"searchDepth":25,"depth":25,"links":1776},[1777,1780,1781,1782,1783,1784,1785,1786],{"id":45,"depth":25,"text":46,"children":1778},[1779],{"id":85,"depth":120,"text":86},{"id":264,"depth":25,"text":265},{"id":397,"depth":25,"text":398},{"id":613,"depth":25,"text":614},{"id":737,"depth":25,"text":738},{"id":838,"depth":25,"text":839},{"id":1348,"depth":25,"text":1349},{"id":1758,"depth":25,"text":1759},"27/10/2025","В статье разберём Web Workers: их преимущества, типизацию в TypeScript, создание и использование в Vue.js",{"script":1790},[1791],{"type":1792,"key":1793,"data-nuxt-schema-org":30,"nodes":1794},"application/ld+json","schema-org-graph",[1795],{"_resolver":1796},"webPage","https://canvas.hrcd.fr/articles/launch-your-porfolio.jpg",{},{"title":1800},"Web Workers в Vue",{"props":1802},{},"/ru/articles/web-workers-v-vue","10",{"_resolver":1796},{"title":1800,"description":1788},{"loc":1803,"images":1808,"videos":1809},[],[],"ru/articles/Web Workers в Vue",[1812,1813,1814,1815,1816,15],"Vue","Typescript ","Performance ","Javascript ","Webworkers","31nvOYm2W8oHXLtuHiu-mBmyypCmUZqSW7tNg1ihsnQ",1761679270534]